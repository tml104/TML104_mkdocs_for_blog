# 学不来Python

## 一些前言

之所以下决心写这个系列，是因为这么长久以来我学Python都是在需要使用时临时参考的网上的教程，加上我自己以前并没有记录自己学习内容的习惯，因而导致我Python学的东西都相当零散且半吊子。因此我写这个系列主要也是要给自己学过的东西做一个归纳方便以后自己查阅。

总所周知，Python的语法简单，因此被各种“机构”用来当做编程的入门语言。然而实际上如果没有接触过编程且不了解Python背后的一些机制的话，这门语言其实非常难学——它的坑太多了。这也是我学这门语言过程中的感悟，因此这个系列也是为了总结一下它的一些坑以免我以后再踩（当然也仅限于我的能力范围内了）。也因为这个原因，我决定给这个系列取名叫“学不来Python”。

最后，我对我自己攥写文章的水平没多少自信，所以其实我写的东西不一定适合给别人看，甚至于说是当做“教程”——这个系列应该说是一个写给我自己看的“教程”，当然我会尽量把我想给自己看的内容写成其他人也能看懂的形式。这个系列也会参考一些网上比较有名的教程（比如liaoxuefeng和Python官网的教程），必要的时候也会给出参考链接。另外，由于我水平有限，这篇文章不会详细地说明这个语言中的每一个细节，更多的时候只是停留在“能用就行”的水平，文中所说的内容也未必100%准确，还请见谅。

如果文中有错误无任欢迎指出。那么最后就请多指教了。

# 基础语法

## 基本概念和Python的特征

Python是**面向对象的语言**：在Python中，任何的类型（如下文提到的数字、字符串）都是某种**类**。

**类**：一种抽象的类型，本质上是一种数据结构，它指代一类有详细定义的事物。例如，数学上的集合（一类事物）可以理解成一种类。人类也是一种类。

**实例、对象**：类中的某个特定的实体称为**实例**，也即**对象**。例如，某个集合{1,2,3}是集合的一个实例，另一个集合{5,6,7}又是集合的另一个实例。某个特定的人也可以理解为“人类”这个类的实例。

当然数学上的集合本身不是数据结构，下文中会提到Python中的一种类型叫set，它就是数学集合在Python中的实现，是一种数据结构。

**成员**：一个类中包含的**属性**和**方法**统称为成员。

**属性**：描述了这个类的所有实例所拥有的属性有哪些。例如，（有限）集合拥有大小这个属性， {1,2}这个集合作为集合类的实例，大小这个属性的值是2。人类拥有身高这个属性，而某个特定的人身高是172cm就是这个特定的人在身高这个属性上的值。

**方法**：描述了这个类的所有实例所能做的操作（通常这些操作会和实例本身有关）有哪些。例如，集合类定义了取交集、并集、删除某元素等操作（这些操作就是方法），那么对于一个特定的集合｛1，2，3｝，它可以与另一个集合｛5，6，7｝取并集、交集从而得到另一个集合，也可以删除集合中某一特定元素得到另一个集合（例如删掉3就可以得到｛1，2｝）。

**变量**：绑定到某个特定实例的指针（在Python意义下）。例如令a=10，那么就说a指向了10。

**函数**：一系列已经封装好了的代码块，接受特定参数并执行（也即调用）后即可返回结果（当然也有可能只是运行而不返回结果）。

Python是**弱类型的语言**：要定义变量，只需要给它赋值一个相应类型的对象实例即可。不需要特别指明其类型。

Python依赖**缩进**区分代码块：优点是大多数时候不需要打花括号和分号来区分代码块和一行的结束，缺点就是Python对缩进的要求极其严格。

## 基本数据类型

Python中有几种基本最常用的基本数据类型，它们的本质都是对象。下面会对这些类型做一些较为详细的说明。

| 类型            | 例子                    | 说明                         |
| --------------- | ----------------------- | ---------------------------- |
| 整数（int）     | 123                     | 高精度大整数                 |
| 浮点数（float） | 114.514,1.0,1e18 |                              |
| 字符串（str）   | "TML104"                |                              |
| 布尔值（bool）  | True,False             | 以大写开头，只有两个合法的值 |
| 复数            | 1+2j                    |                              |

### 整数

#### 十进制

一般地，随便输入某个十进制数就是整数了。但他们不能有多余的前导零。

```python
a=123456
b=-1123
c=0
```

当然你也可以用下划线分割数字，Python会认为他们是连在一起的。

```python
a=114_514
```

#### 其他进制

在对应进制的数前加上“0b”、“0o”、“0x”，就可以以二、八、十进制表示别的整数。

```python
a=0b11
b=-0x3f
c=0o12
```

### 浮点数

可以直观地理解：带有小数点的数就是浮点数。当然，你也可以用科学计数法来表示浮点数，形如“xey”，等价于$x\cdot 10^y$

```python
a=1.0
b=3e9
c=38e38
d=1e-12
```

这里$b=3*10^9$，$c=3.8*10^{39},d=1*10^{-12}$，但要注意他们都是浮点数。

- 注意区分：1和1.0是**两种不同类型的数**，前者是整数（int）、后者是浮点数（float），下文中的除法运算会涉及到这点。

如果小数以0.开头，那么可以省略掉0。下面的a等于-0.03。

```python
a=-.03
```

由于计算机保存浮点数的形式存在一定的“缺陷”导致运算可能会存在精度问题，因此能用整数的情况下尽量用整数。

### 字符串

其实这玩意应该不算基本数据类型了……因为字符串事实上拥有一些高级特性，以后估计会开一节专门说明字符串，因此这里只是先提一嘴。

使用一对半角单引号或双引号包裹的内容是单行字符串，使用三对半角单引号或双引号包裹的内容是多行字符串。

```python
a="Hello,world"
b='''R1
R2
R3
'''
```

注意赋值的时候多行字符串的开头三个引号必须要和变量同行，否则就会变成下文中的注释的写法了。

### 布尔值

这个就没什么好说明的了。布尔值只有两种取值：True、False，注意不像C语言，这里它们开头首字母必须要大写。

``` python
a=True
b=False
```

### 复数

这个类型不怎么常用，这里只是提一下。用"a+bj"来构造一个复数，也可以用complex("a+bj")以字符串来构造复数。

```python
a=complex("1+2j")
b=1+2j
```

## 变量和简单赋值

使用等于号来给变量赋值。上文中已经给出例子。

你也可以同时对多个变量赋值，这样abc三个变量就都是10：

```python
a=b=c=10
```

python中的变量与其说是变量，不如说是某种“指针”——它的本质其实是指向对象的指针（也就是传递引用）。这个概念对理解后面的列表等可变类型会有帮助。

## 删除

给变量a赋值后，可以用del语句删除变量a指向的对象，这样a就重新回到未定义的状态了。

```python
a=[3,4,5]
del a
a #NameError: name 'a' is not defined
```

## 基本运算

下文中将会列出比较常用的运算，不会列出所有运算（因为太多了我自己都不会= =）。

### 代数运算符运算

下文中示例等号右侧表示运算结果。

除非有特殊说明，下表中符号皆为二元运算符，且浮点数、整数、布尔值均可参与运算
$$
\begin{array} {|}
 \hline { 运算                 }&{ 符号             }&{ 特殊说明                                                     }&{ 示例                                                         }\\
 \hline { 加法                 }&{ +                }&{ 对于列表、字符串等对象此符号有特殊用途                       }&{ 1+2 =3\\ [3]+[4] =[3,4]\\ "13"+"222" ="13222"          }\\
 \hline { 减法                 }&{ -                }&{                                                              }&{ 1-2 =-1                                                      }\\
 \hline { 乘法                 }&{ *}&{ 对于列表、字符串等对象此符号有特殊用途                       }&{ 1*2 =2\\ "13"*5 ="1313131313"\\ [3,4]*2 =[3,4,3,4] }\\
 \hline { 整数除法（地板除法） }&{ //               }&{ 返回整数值（向下取整，也即负数方向取整）\\除以0会抛出ZeroDivisionError异常 }&{ 3//4 =0\\ -3//4 =-1                                       }\\
 \hline { 浮点数除法           }&{ /                }&{ 返回浮点数值，除以0会抛出ZeroDivisionError异常               }&{ 3//4 =0.75                                                   }\\
 \hline { 取模                 }&{ \%                }&{ a\%b的结果为a-(a//b)*b，除以0会抛出ZeroDivisionError异常;\\对字符串对象有特殊用途（格式化字符串）;\\注意：根据这个公式，你事实上可以对浮点数取模 }&{ 4\%3
=1\\ 4\%-3 =-2\\ -4\%3 =2\\ -4\%-3 =-1\\ 4.2\%3.0 =1.2000000000000002 }\\
 \hline { 乘方                 }&{ pow(a,b) 或 a**b }&{                                                              }&{ 4**3 =64\\ 2**0.5 =1.4142135623730951                    }\\\\ \hline
\end{array}\\
$$

| 运算                 | 符号             | 特殊说明                                                     | 示例                                                         |
| -------------------- | ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 加法                 | +                | 对于列表、字符串等对象此符号有特殊用途                       | 1+2 =3<br />[3]+[4] =[3,4]<br />"13"+"222" ="13222"          |
| 减法                 | -                |                                                              | 1-2 =-1                                                      |
| 乘法                 | *                | 对于列表、字符串等对象此符号有特殊用途                       | 1*2 =2<br />"13"*5 ="1313131313"<br />[3,4]*2 =[3,4,3,4]     |
| 整数除法（地板除法） | //               | 返回整数值（向下取整，也即负数方向取整），除以0会抛出ZeroDivisionError异常 | 3//4 =0<br />-3//4 =-1                                       |
| 浮点数除法           | /                | 返回浮点数值，除以0会抛出ZeroDivisionError异常               | 3//4 =0.75                                                   |
| 取模                 | %                | a%b的结果为a-(a//b)*b，除以0会抛出ZeroDivisionError异常；对字符串对象有特殊用途（格式化字符串）；注意：根据这个公式，你事实上可以对浮点数取模 | 4%3 =1<br />4%-3 =-2<br />-4%3 =2<br />-4%-3 =-1<br />4.2%3.0 =1.2000000000000002 |
| 乘方                 | pow(a,b) 或 a**b |                                                              | 4**3 =64<br />2**0.5 =1.4142135623730951                     |

### 布尔逻辑运算

参与运算的通常是布尔值。

| 运算 | 符号    | 特殊说明   | 示例                  |
| ---- | ------- | ---------- | --------------------- |
| 或   | a or y  |            | True or False = True  |
| 与   | a and b |            | True or False = False |
| 非   | not a   | 单目运算符 | not False =True       |

### 比较运算

参与运算的通常是布尔值。当然，列表、元组、字符串等也可比较大小，但不等号两边一般得是同类型的对象。

| 运算         | 符号         | 特殊说明                                                     | 示例                                    |
| ------------ | ------------ | ------------------------------------------------------------ | --------------------------------------- |
| 小于         | <            | 列表、元组、字符串：按字典序比较，下同                       |                                         |
| 小于等于     | <=           |                                                              |                                         |
| 大于         | >            |                                                              |                                         |
| 大于等于     | \>=          |                                                              |                                         |
| 等于         | ==           | （通常是）判断两个对象的值是否相等，相等的定义对于不同的对象而言可能不同；特别地，由于浮点数精度问题，对浮点数使用此符号应当慎重 |                                         |
| 对象标识     | is           | 两个对象是同一个对象（这里同一个对象的意思大致是他们的内存地址完全一样）时返回True，否则返回False | 1 is 1 =True<br />[1] is [1] =False     |
| 否定对象标识 | is not       | 上一条的否定形式                                             |                                         |
| 成员检测运算 | in 或 not in | 检测a是（不是）b的一个成员。（或者说a是否在b里）；特别地，对字典来说a是b的键时返回True | 3 in [1,3] =True<br />5 in [1,3] =False |

is的使用和对象的id有关，之后我们会详细说明。

另外，python中还可以把几个比较符号连着写：`a<x<=b`，这种写法就结果而言等价于`a<x and x<=b`，但x的值只会求解一次。此外，`a<x>b`也等价于`a<x and x>b`，a和b之间不会进行比较。

### 位运算

位运算通常在整数下进行。由于python中的整数是大整数，做下面的运算相当于对无穷个二进制补码位做运算（当然实际实现的时候不可能是这样，这么说只是方便理解）

| 运算     | 符号 | 特殊说明                                               | 示例         |
| -------- | ---- | ------------------------------------------------------ | ------------ |
| 按位或   | \|   |                                                        | -3 \| -4 =-3 |
| 按位与   | &    |                                                        | -3&-4 =1     |
| 按位异或 | ^    |                                                        | -3^-4 =1     |
| 按位取反 | ~a   | 等价于返回-a-1                                         | ~-3=2        |
| 左移     | a<<b | 符号位不会移动，多出来的位用0填充；等价于乘以2的b次方  | 22<<3 =176   |
| 右移     | a>>b | 符号位不会移动，减少的位被舍去；等价于地板除以2的b次方 | 22>>3 =2     |

### 类型转换运算函数

类型转换非常灵活，上文提到的基本数据类型几乎都可以相互转换，甚至可以直接把字符串转换成整数、浮点数、复数等。

这些转换非常重要，输入数字需要依赖这些转换用的函数。

| 运算       | 符号                              | 特殊说明                                                     | 示例                              |
| ---------- | --------------------------------- | ------------------------------------------------------------ | --------------------------------- |
| 整数转换   | int(a)                            | 浮点数转换成小数时是向零取整                                 | int(-2.5) =-2                     |
| 浮点数转换 | float(a)                          |                                                              | float(-1) =-1.0                   |
| 复数转换   | complex(re,im) 或 complex(string) | re是实部、im是虚部；也可以直接用a+bj形式的字符串转换成复数   | complex(1,2)<br />complex("1+2j") |
| 字符串转换 | str(a)                            |                                                              | str(12345) ="12345"               |
| 布尔值转换 | bool(a)                           | 对整数来说，只要不是0，就返回True；对字符串来说，只要非空，就返回True；其他类型也可类推 | bool(-1) =True<br />bool(0)=False |

### 基本函数运算

下面的运算理论上属于代数运算，但使用时形如调用函数（事实上他们本质上就是函数），因此单独列出。

| 运算     | 符号             | 特殊说明              | 示例            |
| -------- | ---------------- | --------------------- | --------------- |
| 乘方     | pow(a,b) 或 a**b | （上文已有详细说明）  |                 |
| 绝对值   | abs(a)           |                       | abs(-3) =3      |
| 带余除法 | divmod(a,b)      | 返回二元组(a//b, a%b) | div(4,3) =(1,1) |

### 运算优先级

参见：

<https://docs.python.org/zh-cn/3/reference/expressions.html#operator-precedence>

## 注释

用#开头的一行代码表示注释。也可以用单独的多行字符串表示注释。

``` python
# note

"""
 other note
"""
```

多行注释会在后文的函数中用到，起到类似于函数作用文档的作用。

单行注释有时也有另一个作用。如果你在你的py文件开头加上这么一句注释：

```python
# coding: utf-8
```

那么整个文件将会被编码为utf-8后执行。

你可能会觉得很不自然，因为一般印象中注释除了给人看以外就没什么别的用处了，但在这里它确实影响了程序的运行（你可以把上面的utf-8换成别的随便什么东西，然后运行的时候会报错）。事实上[官方文档](https://docs.python.org/3/reference/lexical_analysis.html#encoding-declarations)把这种操作叫做Encoding declarations，它是通过正则表达式匹配**前两行**注释实现的，作用就是我们提到的改变编码。也就是说这种特殊的写法只对开头前两行注释有用。

有没有别的类似写法可以使得注释改变运行的行为呢？据我所知也就只有这一个了，至于别的有没有……我也不知道（逃）

另外我的写法并不是官方推荐的写法，如果真的要用可以参考官方文档（上文的链接已经给出）。

## 控制台上的输入和输出

在控制台输入输出，主要依靠input和print两个函数。

### print

可以直接输出数字、字符串等类型；print函数会把他们自动转换成字符串类型后输出；

也可以用逗号分隔来同时输出多个内容，他们之间会用空格分隔。

print默认以一个换行符(\n)结尾，可以改变print函数的**end关键字参数**为另一个字符串来改变结尾，例如将它改成一个空串end=''，就可以让它不换行。

```python
a=b=15
print(a,b,"Yes")
print(a,end='')
```

### input

调用此函数后，将会在控制台读入**一行**键盘输入（不包括换行符号），并返回字符串。

也可以给input传入一个字符串作为参数，这样在读入前会先输出一行字符串提示用户输入的内容。（大多数时候这个功能比较鸡肋用不上）

```python
a=input('123\n')
```

要想输入整数、浮点数，需要用上文提到的类型转换函数，以整数为例

```python
a=int(input())
```

当然这样每次每行只能输入一个数。如果你希望每行输入若干个以空格分隔的数（例如三个），可以这么写：

```python
a,b,c=map(int,input().split())
```

input().split()将会把读入的字符串按照空格分隔成若干字符串，最后按顺序塞进一个列表中并返回改列表。map可以以一个函数作为参数(第一个参数)，将一个列表（第二个参数）中的每个元素输入到这个函数中，返回映射后的结果，最后再通过解包语法逐个赋值到a、b、c三个变量中。关于涉及到的列表、字符串方法等之后会详细说明。

如果你想读入数量不定的整数序列（并得到一个列表），有两种写法：

```python
L1=list(map(int,input().split()))
L2=[int(x) for x in input().split()]
```

第一种做法是通过将map对象通过list类型转换函数转换成列表后实现的（注意map这个函数返回的不直接是一个列表，而是一个map对象）。第二种做法用到了列表生成式的特性，之后会详细说明。

## 杂项

### pass

使用pass可以在本应输入代码的地方占位，其没有实际意义。例如你可以这么定义“空函数”：

```python
def Func():
    pass
```

### 分号

使用分号可以“压行”——将本来需要写成多行的代码写在一行

```python
a=1;b=2;c=3;
```

### 反斜杠续行符

使用反斜杠可以将一行拆成若干行，但要注意反斜杠后面不能有别的东西。

```python
print(input().split(\
))
```

# 常用数据结构简介

## 可变对象、不可变对象

**不可变对象**：对象一旦创建，对象中内容就不可再改变，只能用这个对象去创建另一个新的对象。如整数、字符串等。

**可变对象**：对象中的内容在创建后仍然是可变的。如列表、字典、集合。

需要注意的是，整数的运算其实是在算完之后新建了一个整数对象，而不是在原有对象基础上修改值。字符串等也同理，字符串的拼接等操作实际上是新生成了另一个字符串对象。而对于可变对象而言就未必了，可能有些方法是改变原来对象的，可能有些是返回新对象的。

要想看两个变量所指向的对象是不是**同一个**对象，可以使用id函数查看对象的地址。只有地址完全相同，两个对象才相同，这点已在之前对is的说明中提到。

## 列表

列表类似于C中的vector，不过实际上它更接近广义表。

- 列表是**可变**的：表可以自由地增加、删除元素，也可以改变列表中某个特定位置元素的值，长度不定。
- 表中元素可以是任何对象（比如整数、浮点数、另一个列表等等），表中元素甚至可以是自己。

### 新建列表

```python
a=[] #空列表
b=[1,2,3,[4,5,6]] #有初始值的列表，最后一个元素是另一个列表，因此这个列表是嵌套的
c=list("abc") #使用其他可迭代对象构造新列表
```

list函数是构造一个新列表用的函数。如果不传入参数那么将会返回空列表（因此`a=list()`和`a=[]`效果一样），如果传入了另一个可迭代对象（之后会提到），那么它会以可迭代对象中的每一个元素作为列表中的元素。

关于列表的详细方法参见之后的“常用数据结构方法与相关常用函数”。

## 元组

与列表类似，但是，它的元素在初始化完成之后就不再可改变。

- 元组是**不可变的**：不能删除或者添加元素。
- 表中元素可以是任何对象。

### 新建元组

```python
a=() #空元组
b=(4,2,3,[5,7],(6,1)) #带有若干初始元素的元组
c=4,2,3, #在没有歧义的情况下，等号右值省略括号也相当于元组
d=tuple([1,2,3]) #d==(1,2,3)
```

tuple同样是用于构造一个新元组用的函数。

## 列表和元组中的元素问题

需要指出的是，“元组是不可变的”指的是元组中所包含的“内容”不能再更改了。但“内容”指的究竟是什么呢？

之前的文章提到了在python中变量的本质实际上是指向对象的”指针“，因此，如果你是通过这个指针去改变了一个可变对象，那么所有指向这个对象的指针（也即变量）所指向的内容自然也会发生改变。例如：

```python
a=b=[1,2,3]
a.append(4) #在列表末尾插入新元素
print(a,b) #[1, 2, 3, 4] [1, 2, 3, 4]
```

可以看到，由于a和b指向的是同一个对象，因此对这个对象的操作会影响到所有指向这个对象的变量。

再看一个嵌套列表的例子，这个列表最后一个元素是另一个列表，我们试图对最后这个列表插入元素：

```python
b=[1,2,3,[4,5,6]]
a=b[3] #取得指向[4,5,6]的变量（指针）
a.append(4)
print(b) #[1,2,3,[4,5,6,4]]
```

省略掉a变量依然能够成功：

```python
b=[1,2,3,[4,5,6]]
b[3].append(4)
print(b) #[1,2,3,[4,5,6,4]]
```

可以看到b中显示的内容也发生了改变。这说明了一个问题：**列表中的另一个列表**，实际上存的也是指向这个**另一个列表的指针**，或者说是一种**引用**，真正的这个另一个列表其实在另一个地方存着。只是在这里并没有一个明显的变量表明它是一个”引用“。

如果把上例中的b改成元组而别的不变，那么去改变列表就会导致b指向的元组“看上去变了”，但实际上元组中存的是指向各个对象的指针，元组确实没有改变。

```python
b=(1,2,3,[4,5,6])
b[3].append(4)
print(b) #(1,2,3,[4,5,6,4])
```

## 集合

类似数学上的集合，一个集合中的元素是唯一的。插入集合中已有的元素后，集合会自动合并重复的元素。

- 集合是**可变的**。

- Python中的集合底层是用哈希实现的，因此插入或初始化集合的对象必须要是**可哈希的**（hashable）。数、字符串、不包含可变对象的元组都是可哈希的，但可变对象（如列表）就不是。

### 新建集合

```python
s=set()
s=set([1,2,5,8,0]) #有初值的初始化：{0,1,2,5,8}
```

虽然集合形如{}，但是不能用{}新建一个空集合，因为这么写其实是在新建一个空字典。

## 字典

如果你接触过json或者C++的map的话你应该对字典很熟悉。字典保存了一系列键值对的集合，并可把键用类似于索引的方式取得值。

- 字典是**可变的**。
- **键**必须要是**可哈希的**，和集合类似。字典底层也是用哈希表实现的。

### 新建字典

```python
s={} #空字典
s=dict() #空字典
s={1:2,"3":4,(5):[6,7,8]} #带有整数、字符串和元组作为键的字典
s[1]
s["3"] #按照索引取得值
```

## 字符串

字符串之前已经提到过，这里

- 字符串是**不可变的**

### 前缀

| Prefix |                                                              |
| ------ | ------------------------------------------------------------ |
| r R    | 原生字符串，不会转义                                         |
| f F    | 格式字符串（参见格式化字符串一节）                           |
| u U    | 默认的前缀，表示以Unicode方式保存字符串                      |
| b B    | 生成bytes类型，其中只允许使用ascii字符，超出127的字符需要转义。序列中的每个值的大小被限制为 `0 <= x < 256` (如果违反此限制将引发 [`ValueError`](https://docs.python.org/zh-cn/3/library/exceptions.html#ValueError)) |

## 可迭代对象(Iterable)、迭代器（Iterator）

**可迭代对象**：可被for循环（之后会提到）迭代的对象统称为可迭代对象。列表、字典、元组、集合、字符串等都是可迭代对象。

**迭代器**：

## 浅拷贝、深拷贝

# 常用数据结构方法与相关常用函数

## 共通操作与方法

**序列类型**：列表、元组、range、字符串等

### 通用操作

几乎所有对象都能用，包括列表和元组、字典、集合、字符串等

| 运算、函数或方法 | 符号                 | 特殊说明                                                 | 示例 |
| ---------------- | -------------------- | -------------------------------------------------------- | ---- |
| 成员检测运算     | a in b 或 a not in b | 见上文基本运算一节；特别地，对字典来说a是b的键时返回True |      |
| 取得长度         | len(a)               | 取得a对象的长度（元素个数）                              |      |
| 最小值           | min(a)               | a中元素最小值                                            |      |
| 最大值           | max(a)               | a中元素最大值                                            |      |

### 序列通用操作

除非有特殊说明，下面的操作可用于元组、列表、字符串。

| 运算、函数或方法 | 符号           | 特殊说明                                                     | 示例                                              |
| ---------------- | -------------- | ------------------------------------------------------------ | ------------------------------------------------- |
| 串接             | a+b            | 首尾相接，返回新对象                                         | [1,2]+[3,4] =[1,2,3,4]                            |
| 重复             | s*n (n是整数)  | 重复n次自己对自己的串接，返回新对象；重复的元素将会引用被复制的对象 | "ab"*3="ababab"                                   |
| 索引             | s[i]           | 取s中第i个（自0开始计数）元素，可以为负数（相当于下标变为n-i）；越界访问会抛出IndexError异常 | "ab"[1] ="b"                                      |
| 切片             | s[i:j]         | 取s中第i到j个（不包括第j个）元素，步长为1；超出范围的i、j会被自动规约到0或len(s)；若i、j缺省会自动设定成0和len(s) | “abcd”[2:4]="cd"                                  |
|                  | s[i:j:k]       | 由满足x=i+nk的所有s[x]组成的序列，其中n是所有满足0<=n<(j-i)/k的整数；超出范围的i、j会被自动规约；缺省的i、j会被自动设定成开始或结束位置（取决于k的正负） | "abcd"[1:4:2]="bd"<br />"abcd"[::-1]="dcba"<br /> |
| 查找索引         | a.index(x)     | 在a中找到第一次出现x的下标；找不到会抛出ValueError异常       | [2,3,5,4].index(3) =1                             |
|                  | a.index(x,i,j) | 等价于在a[i:j]中找第一次出现x的对应的a的下标                 | [2,3,5,4].index(3,1,2) =1                         |
| 计数             | a.count(x)     | 返回x在a中出现次数                                           | [1,1,2,3,5].count(1)=2                            |

- 重复、切片等操作是浅拷贝

### 可变序列通用操作

就目前而言，主要是列表会用到这些独有的操作。其中有些操作其他可变类型（但不是可变序列类型）也可使用。

| 运算、函数或方法 | 符号                                       | 特殊说明                                                     | 示例                          |
| ---------------- | ------------------------------------------ | ------------------------------------------------------------ | ----------------------------- |
| 赋值             | a[i]=x<br />a[i:j]=x<br />a[i:j:k]=x       |                                                              |                               |
| 删除             | del a[i]<br />del a[i:j]<br />del a[i:j:k] | del操作还可以用在单独的对象上；**字典可用左格当中的第一个操作** |                               |
| 尾部插入         | a.append(x)                                | 在末尾插入新元素                                             |                               |
| 清空             | a.clear()                                  | **字典、集合也可用**                                         |                               |
| 浅拷贝           | a.copy()                                   | 就结果等于a[:]；**字典、集合也可用**                         |                               |
| 扩展             | a.extend(b)                                | 相当于用可迭代对象b转换成对应序列后再串接；就结果等于a+=b    | [1,2].extend((3,4))=[1,2,3,4] |
| 一般插入         | a.insert(i,x)                              | 在下标i之后插入x，之后的元素都向后移动一位                   |                               |
| 弹出             | a.pop([i])                                 | 删掉第i个元素；如果省略i则默认删掉最后一个元素               |                               |
| 移除             | a.remove(x)                                | 删掉第一个等于x的元素                                        |                               |
| 反转             | a.reverse()                                |                                                              |                               |

## 列表

| 运算、函数或方法     | 符号                              | 特殊说明                                                     | 示例 |
| -------------------- | --------------------------------- | ------------------------------------------------------------ | ---- |
| **通用操作**         |                                   | （见上文）                                                   |      |
| **序列通用操作**     |                                   |                                                              |      |
| **可变序列通用操作** |                                   |                                                              |      |
| 构造                 | list([iterable])                  | 可传入可迭代对象构造列表                                     |      |
| 排序                 | a.sort([key=None, reverse=False]) | 默认从小到大排序；将关键字参数reverse赋值为True可从大到小排序；key传入一个函数则可自定义比较规则 |      |

列表生成式特性见下文。

## 元组

| 运算、函数或方法 | 符号              | 特殊说明                 | 示例 |
| ---------------- | ----------------- | ------------------------ | ---- |
| **通用操作**     |                   | （见上文）               |      |
| **序列通用操作** |                   |                          |      |
| 构造             | tuple([iterable]) | 可传入可迭代对象构造元组 |      |

## 集合

集合允许一些简单的集合运算。

| 运算、函数或方法      | 符号                                     | 特殊说明                                             | 示例 |
| --------------------- | ---------------------------------------- | ---------------------------------------------------- | ---- |
| **通用操作**          |                                          | （见上文）                                           |      |
| 构造                  | set([iterable])                          | 可传入可迭代对象构造集合，但其中的元素必须是可哈希的 |      |
| 浅拷贝                | s1.copy()                                |                                                      |      |
| 添加元素              | s1.add(x)                                |                                                      |      |
| 删除元素              | s1.remove(x)                             | 不存在则抛出KeyError                                 |      |
| 移除元素              | s1.discard(x)                            | 不存在则什么也不做                                   |      |
| 弹出元素              | s1.pop()                                 | 弹出"第一个元素"；空集合会抛出KeyError               |      |
| 清空                  | s1.clear()                               |                                                      |      |
| 交集                  | s1 & s2 或者 s1.intersection(s2)         | 返回两个集合的交集                                   |      |
| 并集                  | s1 \| s2 或者 s1.union(s2)               |                                                      |      |
| 对称差集（异或）      | s1 ^ s2 或者 s1.symmetric_difference(s2) |                                                      |      |
| 差集                  | s1 - s2 或者 s1.difference(s2)           |                                                      |      |
| 上面4条操作的更新版本 | s1 \|= s2 , s1&=s2, s1-=s2, s1^=s2       |                                                      |      |
| 子集判定              | s1 <= s2 或 s1.issubset(s2)              | 符合条件返回True，下同                               |      |
| 真子集判定            | s1 < s2                                  |                                                      |      |
| 超集判定              | s1>=s2 或 s1.issuperset(s2)              |                                                      |      |
| 真超集判定            | s1 > s2                                  |                                                      |      |
| 相交判定              | s1.isdisjoint(s2)                        | 交集空则返回True                                     |      |

## 字典

下面会列出字典的常用方法（不是全部）

| 运算、函数或方法 | 符号                                               | 特殊说明                                                     | 示例 |
| ---------------- | -------------------------------------------------- | ------------------------------------------------------------ | ---- |
| **通用操作**     |                                                    | （见上文）                                                   |      |
| 构造             | dict([(k1:w1),(k2:w2),...])<br />dict(k1=w1,k2=w2) | 可传入列表（列表中是若干两个值组成的元组）构造字典，也可传入关键字参数构造字典等。详细见官方文档 |      |
| 浅拷贝           | d.copy()                                           |                                                              |      |
| 清空             | d.clear()                                          |                                                              |      |
| 索引和赋值       | d[k]<br />d[k]=x                                   | k不存在时，相当于插入新的键值对；字典会确保自己的元素按照插入顺序排列 |      |
| 按键取值         | d.get(k,[def=None])                                | 返回这个键对应的值；如果指定了def参数则会在找不到k这个键的时候返回def，否则返回None |      |
| 按键删除         | del d[k]                                           | 找不到k这个键则抛出KeyError                                  |      |
| 按键删除2        | d.pop(k,[def=None])                                | 删除键值对并返回这个键对应的值；如果指定了def参数则会在找不到k这个键的时候返回def，否则会抛出KeyError |      |
| 弹出元素         | d.popitem()                                        | 弹出第一个键值对并返回之（以元组形式）                       |      |
| 设置默认值       | d.setdefault(k,[def=None])                         | 字典中已存在k则返回d[k]，否则d[k]=def，并返回def的内容       |      |
| 更新             | d.update([dd]) 或 d \|= dd （Py3.9）               | 使用dd（字典或由若干两个值组成的元组构成的列表）更新d中的内容 |      |
| 合并（py3.9）    | d\| dd                                             | dd是另一个字典，将创建两个字典合并的新字典。（以dd中的键值对优先） |      |
| 视图对象         | d.items()<br />d.keys()<br />d.values()            | 获取键值对、键、值的视图对象，主要用于迭代                   |      |

## 字符串

字符串的方法相当多，这里也只能列出比较常用的方法

| 运算、函数或方法   | 符号                         | 特殊说明                                                     | 示例                                                         |
| ------------------ | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **通用操作**       |                              | （见上文）                                                   |                                                              |
| **序列通用操作**   |                              |                                                              |                                                              |
| 构造               | str([iterable])              | 可传入可迭代对象构造字符串                                   |                                                              |
| 计数               | s.count(s2,[st,ed])          | 返回s2在s[st:ed]内的出现次数                                 | "abcdeeee".count("e",5,7)=2                                  |
| 查找               | s.find(s2,[st,ed])           | 返回s2在s[st:ed]内出现的最小下标;找不到则返回-1              | "abcdeee".find("e")=4                                        |
| 反向查找           | s.rfind(s2,[st,ed])          | 同上，但找的是最大下标                                       | "abcdeee".rfind("e")=6                                       |
| 分隔               | s.partition(s2)              | 在s中找到s2第一次出现的位置，并将s拆成s2前、s2和s2后三个串，返回这三者构成的元组（a，b，c）；如果没有找到s2则b、c将会是空串 | "abcdeee".partition("de") =('abc', 'de', 'ee')<br />"abcdeee".partition("k")=('abcdeee', '', '') |
| 拆分               | s.split(s1=None,maxsplit=-1) | 将字符串以s1位分隔符拆分成若干字符串并组成列表；（如果s1缺省则表明以任意长空格作为分隔符号）；指定maxsplit为正值则表明此拆分最多会进行这么多次 | "h e ll o".split()=['h', 'e', 'll', 'o']<br />"wawawawa".split("a",2)=['w', 'w', 'wawa'] |
| 替换               | s.replace(s1,s2,[cnt])       | 将s中出现的s1子串全部替换成s2；指明cnt表明最多进行cnt次替换  | 'abcabcabc'.replace('abc','d',2)='ddabc'                     |
| 拼接               | s.join(L)                    | 以字符串s作为分隔符号，将可迭代对象L（元素必须全是字符串）中的所有元素串接 | '\|'.join(["L","O","V","E"])="L\|O\|V\|E"<br />''.join(["L","O","V","E"])="LOVE" |
| 小写化、大写化     | s.lower()<br />s.upper()     | 将s转换为全小写或全大写                                      |                                                              |
| 全小写、全大写判定 | s.islower()<br />s.isupper() | s中的字母全是小写或大写则返回True                            |                                                              |
| 空格串判定         | s.isspace()                  | s非空且全是空格，返回True                                    |                                                              |
| 数字串判定         | s.isdigit()                  | s全是阿拉伯数字，返回True                                    |                                                              |
| 编码               | s.encode(encoding="utf-8")   | 指定字符串s的编码，在写爬虫的时候可能有用；默认用utf-8编码   |                                                              |
| 格式化             | s.format(...) 或 s1 % ...    | 参见之后的格式化字符串                                       |                                                              |

- 字符串的上述涉及查找子串的操作使用的算法是[Boyer-Moore](https://en.wikipedia.org/wiki/Boyer–Moore_string_search_algorithm)，平均情况下复杂度为O（n），但最差情况下可达O（nm）

## 其他特性

### 推导式

在创建列表、集合和字典时，可让列表以一定的规则生成其中的元素，以列表为例：

```python
L=[x for x in range(1,11)]
```

这个例子会把L=[1,2,3,4,5,6,7,8,9,10]。range函数会生成1到11-1=10共10个数字的序列，for循环会迭代这个类型，并将迭代到的元素（经过一些处理后）逐个作为L中的元素。

更一般地，**列表推导式的语法**：（标准的巴科斯范式表示法见<https://docs.python.org/zh-cn/3/reference/expressions.html#grammar-token-comp-for>）

```python
表达式 for 变量1 in 可迭代对象 [if 条件] for 变量2 in 可迭代对象 [if 条件] ...
```

变量1、2、...是在表达式中涉及到的变量。其中各个变量必须满足条件才会被考虑，不满足条件就会跳过。

例如，下面的代码会生成[2,4,6,8]和[21,23,25,27,29]中元素两两相加的结果组成的列表：

```python
[x+y for x in range(1,10) if x%2==0 for y in range(20,30) if y%2==1]
#[23, 25, 27, 29, 31, 25, 27, 29, 31, 33, 27, 29, 31, 33, 35, 29, 31, 33, 35, 37]
```

把前一个if条件拉到后面的if中，起到的效果是一样的

```python
[x+y for x in range(1,10) for y in range(20,30) if y%2==1 and x%2==0]
#[23, 25, 27, 29, 31, 25, 27, 29, 31, 33, 27, 29, 31, 33, 35, 29, 31, 33, 35, 37]
```

对**集合**而言，只需要把上面的框换成花括号就能变成集合推导式了：

```python
{x+y for x in range(1,10) for y in range(20,30) if y%2==1 and x%2==0}
#{33, 35, 37, 23, 25, 27, 29, 31}
```

对**字典**而言，表达式需要改成用引号分隔的两个表达式，需要注意的是一开始的键值对可能会被后来的覆盖：

```python
{x-y:x+y for x in range(1,10) if x%2==0 for y in range(20,30) if y%2==1}
#{-19: 35, -21: 37, -23: 35, -25: 33, -27: 31, -17: 33, -15: 31, -13: 29}
```

**总结一下就是：**

```python
#列表、集合推导式
表达式 for 变量1 in 可迭代对象 [if 条件] for 变量2 in 可迭代对象 [if 条件] ...
#字典推导式
表达式1:表达式2 for 变量1 in 可迭代对象 [if 条件] for 变量2 in 可迭代对象 [if 条件] ...
```

当然上文中我们只讨论了三中类型的推导式。既然列表都有推导式了，那元组呢？元组事实上没有推导式这个说法，如果真的想要获得一个推导式推导出的元组，请先使用列表推导式，然后使用tuple函数转换成元组。

简单地将推导式最外层的花括号或方括号换成圆括号，得到的将是生成器推导式而不再是元组，其行为也和序列对象不一样，因此以后我们再讨论它。

# 常用函数总结

这里将按用途类型把常用的内置函数（不包括内置模块里的函数）做划分。

## 类型转换函数

这些函数已经在前面的“基本数据类型”中提到，这里将只列出它们。

### int(x,base=10) -> int

输入x，将x以base进制解析成10进制后返回整数.

### float(x) ->float

### bool(x) -> bool

### complex(x) -> complex

## 常用数据结构构造函数

这些函数已经在前面的“常用数据结构方法与相关常用函数”中提到，这里将只列出它们。

### list([iterable]) -> list

### tuple([iterable]) ->tuple

### str([iterable]) -> str

### set([iterable]) -> set

### dict(...) -> dict

## 数学和进制转换

更多与数学有关的函数请参考math库中的函数。

### abs(x)

返回x的绝对值或模（复数）

### max(x,y,...) 或 max([iterable])

传入至少两个参数或者一个可迭代对象，将返回这些参数或这个对象中的（第一个）最大元素。

### min(x,y,...) 或 min([iterable])

同上，但返回（第一个）最小元素。

### sum([iterable])

传入可迭代对象，返回对象中所有元素的和

### pow(a,b,[m])

返回a的b次幂，如果指定了m（必须是整数），那么返回a的b次幂对m取余数的结果。

py3.8中，b支持在传入m的情况下传入负数了，这意味着你可以直接用这个函数求一个数的模逆元。

### divmod(a,b)

带余除法，返回二元组(a//b, a%b)。

### round(x,[d])

将x四舍五入到d位小数，d未指定则表明四舍五入到整数。

但要注意，由于浮点数精度问题，某些数值可能会在边界处产生反直觉的结果。例如

```python
round(4.5) #4
round(5.5) #6
```

### hex(x)

输入整数x，返回0x开头的16进制字符串。

### oct(x)

同上，返回0o开头的8进制字符串。

### bin(x)

同上，返回0b开头的2进制字符串。

## 输入和输出

### input([prompt])

从标准输入读入一行字符串。指定prompt以在读入前输出一行提示。

### print(*obj, sep=' ' , end='\n', file=sys.stdout, flush=Fase)

输出若干个传入的obj参数，每个参数之间以sep分隔（默认是空格），输出完成后再输出一个end字符串（默认是换行）。

指定file以规定输出到何处，默认是标准输出流。

指定flush为True，则输出完成后将刷新输出流（立即将缓冲区的内容都输出到文件中）。

### open(f, mode='r', ...)

打开文件f并返回文件对象，利用这个文件对象可以向里面读写内容。

mode指定'r'为读取，指定'w'为写入。在这之后追加写'b'、't'可以二进制模式（例如读写图片）或文本模式（默认）读写，追写'a'代表文件存在时在末尾追加读写等。具体说明参看官方文档。

## 迭代相关函数

### range([st],ed,[step])

生成一个从st（默认为0）到ed（不包括ed），步长为step（默认为1）的range序列对象。通常用于for循环迭代。

range对象是不可变的序列类型，也支持一些（但不是所有）序列操作：

| 运算、函数或方法                 | 符号       | 特殊说明   | 示例 |
| -------------------------------- | ---------- | ---------- | ---- |
| **通用操作**                     |            | （见上文） |      |
| **序列通用操作**(串接、重复除外) |            |            |      |
| 构造                             | range(...) |            |      |

使用range对象迭代会比使用列表生成式生成的一串序列更高效。

### iter(iterable)

返回可迭代对象的一个迭代器（iterator）（从头开始）。

### reversed(iterable)

返回可迭代对象的反向迭代器（for循环时，将从L的尾部到头部迭代）

### zip(*[iterables])

同时迭代多个可迭代对象。当这当中最短的一个可迭代对象迭代完毕时，结束迭代。

```python
for x,y,z in zip([1,2],[3,4,5],[6,7]):
    print(x,y,z)
#1 3 6
#2 4 7
```

### enumerate(iterable, start=0)

返回另一个可迭代对象，对象中的每一个元素以元组(i,v)表示，i表示其是第i个（从0开始计数）元素，v表示元素内容。

```python
for i,v in enumerate([7,8,9]):
    print(i,v)
#0 7
#1 8
#2 9
```

### next(iterator,[def])

传入迭代器，返回迭代器所指元素并令迭代器移动到下一个位置。如果迭代完了会抛出StopIteration。

## 字符

### chr(x)

x是整数，返回对应unicode值的单个字符的字符串。例如chr(65)='A'

### ord(x)

x是只有一个字符的字符串，返回字符对应的Unicode码。不是一个字符的字符串会抛出TypeError。

## 排序

### sorted([iterable],*,key=None, reverse=False)

返回新的已排序的可迭代对象。

指定key为函数可改变用于比较“大小”的规则。指定reverse为True可使其从大到小排列。更多请参考官方文档：<https://docs.python.org/zh-cn/3/howto/sorting.html#sortinghowto>。

## 类型判定

### isinstance(obj,cls)

检测obj是否是cls这个类的一个实例。

```python
isinstance([1,2,3],list) #True
from collections.abc import Iterable
isinstance([1,2,3],Iterable) #True
```

### type(obj)

返回obj的类型（一个type对象）。

```python
type(123)
# <class 'int'>
```

## 执行

### eval(obj,...)

将obj（通常是字符串）当作python表达式运行，然后返回运行结果。有语法错误会抛出SyntaxError。

### exec(obj, ...)

将obj（通常是字符串）当作python代码执行。返回None。有语法错误会抛出SyntaxError。

# 常用内置库函数总结

## math

Python的内置数学库

```python
import math
```

### 浮点数

### ceil(x)

返回x的向上取整值

### floor(x)

返回x的向下取整值

### isclose(a,b,*,rel_tol=1e-9,abs_tol=0.0)

判断两个浮点数a、b是否足够相近，允许的误差为rel_tol。

### fabs(x)

x的绝对值（浮点数）

### fmod(x,y)

适用于浮点数的取模运算

### 组合计数相关

### comb(n,k)

组合数$C_{n}^k$

### factorial(x)

返回x的阶乘，x需要是大于等于0的整数，否则会抛出异常。

### perm(n,k=None)

k<=n，返回$\frac{n!}{(n-k)!}$；否则返回0

### 数论

### gcd(a,b)  /  gcd(*ints)

输入两个/若干（Py3.9）整数，返回这些数的最大公因数。特别地，输入的数全为0时，返回0。这和自己手写的gcd函数行为相同。

### lcm(*ints) (Py3.9)

输入若干整数，返回最小公倍数。

### 求积与求和

### prod(iterable,*,start=1)

求可迭代对象的积，初始值为start。

### fsum(iterable)

返回可迭代对象中的浮点值和（精确地）

### 算数

### exp(x)

指数函数

### log(x,[base])

以base为底数的x的对数

### log2(x)  log10(x)

类似上一函数

### sqrt(x)

算数平方根

### isqrt(x)

上一函数的向下取整值

### sin(x) cos(x) tan(x) asin(x) acos(x) atan(x)

三角函数

### atan2(y,x)

以弧度为单位返回atan(y/x)，结果在$[-\pi,\pi]$之间。

### dist(p,q)

p、q是可迭代对象，返回他们的欧几里得距离。

### 常数

### pi e tau（2pi）

## cmath

用于复数算数的库

### phase（x）

返回复数x的相位。[-pi,pi]之间

### polar（x）

返回复数x在极坐标系中的表示方式（二元组）

### rect（r，phi）

通过极坐标的半径和角度返回对应复数

## random

伪随机数库

### 序列

### choice（seq）

从非空序列 *seq* 返回一个随机元素。

### shuffle（x，[random]）

将x按照random函数生成的值（[0.0,1.0)）随机打乱。

### 随机数

### random()

返回[0.0,1.0)内的随机数

### uniform（a，b）

返回a~b内的随机浮点数

### randint（a，b）

返回a~b内的随机整数

### randrange(st,ed, [step]) / randrange(ed)

参数形如range，返回这之中的一个数

## [`statistics`](https://docs.python.org/zh-cn/3/library/statistics.html#module-statistics)

统计学函数。如无特殊说明，下文中函数参数为可迭代对象

### mean（x）

算数平均数

### fmean（x）

快速计算算数平均数（总是返回浮点数）

### median(x) / median_low(x) / median_high(x)

中位数/高中位数/低中位数

## itertools

包括各类用于迭代容器的函数

### `permutations`(*iterable*, *r=None*)

连续返回由 *iterable* 元素生成长度为 *r* 的排列（迭代器）。

### `combinations`(*iterable*, *r*)

返回由输入 *iterable* 中元素组成长度为 *r* 的子序列。

### `combinations_with_replacement`(*iterable*, *r*)

返回由输入 *iterable* 中元素组成的长度为 *r* 的子序列，允许每个元素可重复出现。

## datetime

## os

# 字符串格式化

<https://docs.python.org/zh-cn/3/tutorial/inputoutput.html#formatted-string-literals>

## s.format(*args, **kwargs)

格式化s中带有花括号的部分。

1. \*args ： 依次替换，或者根据花括号中的索引替换
2. **kwargs：字典，根据花括号中的值作为键来替换

```python
"The sum of 1 + 2 is {0}".format(1+2)
```

## 格式字符串语法

大概长这样：

```python
{ [域名] [! 转换旗标] [: 格式控制符] }
```

1. 域名：如果为数字，则它指向一个位置参数，而如果为关键字，则它指向一个命名关键字参数。（省略则默认为位置参数从0递增）

2. 转换旗标：

   - a：相当于在代入前套用一次ascii函数
   - s：相当于在代入前套用一次str函数（影响print的输出）
   - r：相当于在代入前套用一次repr函数（repr会影响对象在控制台的输出）

3. 常用的格式控制符（格式规格迷你语言）：

   `format_spec     ::=  [[fill]align][sign][#][0][width][grouping_option][.precision][type]`

   - 填充fill：如果指定了一个有效的 *align* 值，则可以在该值前面加一个 *fill* 字符，它可以为任意字符，如果省略则默认为空格符。
   - 对齐选项align：< > = ^ 分别表示 左右对齐、强制将填充放置在符号（如果有）之后但在数字之前。这用于以“+000000120”形式打印字段、居中。
   - *width*：是一个定义最小总字段宽度的十进制整数，包括任何前缀、分隔符和其他格式化字符。 如果未指定，则字段宽度将由内容确定。
   - *precision*： 是一个十进制数字，表示对于以 `'f'` and `'F'` 格式化的浮点数值要在小数点后显示多少个数位，或者对于以 `'g'` 或 `'G'` 格式化的浮点数值要在小数点前后共显示多少个数位。

一些使用例子

```python
'X: {0[0]};  Y: {0[1]}'.format(coord) #coord=(3,5)
# 'X: 3;  Y: 5'

'{:<30}'.format('left aligned')
# 'left aligned                  '
'{:^30}'.format('centered')
# '           centered           '
'{:*^30}'.format('centered')  # use '*' as a fill char
#'***********centered***********'

'Correct answers: {:.2%}'.format(points/total)
# 'Correct answers: 86.36%'
```

## f-string

```python
f'{variable: format_spec}'
```

## 旧格式化方法

```python
'%d %5.3f' % (1,2)
# '1 2.000'
```

字符串后的百分号须是元组或字典。若是字典，字符串中的百分号应该写成`%(key)d`的形式。（而且字典键必须是字符串才行）

<https://docs.python.org/zh-cn/3/library/stdtypes.html#old-string-formatting>

# 解包

# （整数的）id

# 条件判断和循环

# 第三方库

## Request

## Panda

```python
import pandas as pd
```

### Dataframe

二维表格

```panda
df = pd.DataFrame(
    {
        "Name": [
            "Braund, Mr. Owen Harris",
            "Allen, Mr. William Henry",
            "Bonnell, Miss. Elizabeth",
        ],
        "Age": [22, 35, 58],
        "Sex": ["male", "male", "female"],
    }
)

                       Name  Age     Sex
0   Braund, Mr. Owen Harris   22    male
1  Allen, Mr. William Henry   35    male
2  Bonnell, Miss. Elizabeth   58  female
```

### Series

每一列就是一个Series

```python
df["Age"]

0    22
1    35
2    58
Name: Age, dtype: int64
```

```python
ages = pd.Series([22, 35, 58], name="Age")
```

# conda

## 在powershell下运行

<https://github.com/conda/conda/issues/8428>

<https://blog.csdn.net/z_dmsd/article/details/107394983>

<https://zhuanlan.zhihu.com/p/89356758>

在powershell中运行请先

```
powershell -ExecutionPolicy Bypass
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
...
conda init powershell
...
```

## 清洁

<https://www.jianshu.com/p/f14ac62bef99>

```
conda clean -a
```

## 环境

创建环境、删除、激活和退出，安装包

```
conda create -n ngs python=3.8
conda remove -n ngs --all
conda activate ngs
conda deactivate
conda install package
```

## 常用命令

```
# to search for packages

conda search [package]

# To update all packages

conda update --all --yes

# List all packages installed

conda list [-n env]

# conda list environments

conda env list

# create new env

conda create -n [name] package [package] ...

# activate env

conda activate [name]

# deavtivate env

conda deactivate

# view conda configuration information

conda --version

conda info 

conda info --envs
```

# pip

```bash
pip --default-timeout=100 --no-cache-dir install matplotlib -i https://mirrors.aliyun.com/pypi/simple/
```

换源参考：<https://blog.csdn.net/weixin_41524411/article/details/114191177>

缓存：<https://reality0ne.com/pip-cahce-dir/>

缓存保存在当前用户home下的.cache中。要避免cache可以用--no-cache-dir
